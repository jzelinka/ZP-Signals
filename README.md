TODO add some description of what this code achieves
